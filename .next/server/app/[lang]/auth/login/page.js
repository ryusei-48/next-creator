(()=>{var e={};e.id=6666,e.ids=[6666],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},67096:e=>{"use strict";e.exports=require("bcrypt")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},41790:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page-experimental.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},73292:e=>{"use strict";e.exports=require("fs/promises")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},63477:e=>{"use strict";e.exports=require("querystring")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},81917:(e,s,r)=>{"use strict";r.r(s),r.d(s,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d});var t=r(10426),a=r(19361),n=r(19234),i=r.n(n),o=r(76566),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(s,l);let d=["",{children:["[lang]",{children:["auth",{children:["login",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,37129)),"/var/www/next-creator/app/[lang]/auth/login/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,75300)),"/var/www/next-creator/app/[lang]/layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,84643)),"/var/www/next-creator/app/[lang]/error.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,94954)),"/var/www/next-creator/app/[lang]/loading.tsx"]}]},{"not-found":[()=>Promise.resolve().then(r.t.bind(r,16452,23)),"next/dist/client/components/not-found-error"]}],c=["/var/www/next-creator/app/[lang]/auth/login/page.tsx"],u="/[lang]/auth/login/page",p={require:r,loadChunk:()=>Promise.resolve()},m=new t.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/[lang]/auth/login/page",pathname:"/[lang]/auth/login",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},80211:(e,s,r)=>{Promise.resolve().then(r.bind(r,8558)),Promise.resolve().then(r.bind(r,10349)),Promise.resolve().then(r.bind(r,95847)),Promise.resolve().then(r.bind(r,5404)),Promise.resolve().then(r.bind(r,812)),Promise.resolve().then(r.bind(r,54347)),Promise.resolve().then(r.bind(r,45528)),Promise.resolve().then(r.bind(r,11175)),Promise.resolve().then(r.bind(r,81194)),Promise.resolve().then(r.t.bind(r,22272,23)),Promise.resolve().then(r.t.bind(r,51846,23))},8558:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>LoginPage});var t=r(92983),a=r(76078),n=r(7247),i=r(15100),o=r(77941),l=r(76243),d=r.n(l),c=r(53569),u=r.n(c);function LoginPage({useLang:e,defaultLang:s,locales:r,localeLabels:l,userCount:c}){let p=(0,o.useRouter)(),{register:m,handleSubmit:x,getValues:g,trigger:h,formState:{errors:_}}=(0,n.cI)({mode:"onChange"}),{register:b,handleSubmit:w,getValues:v,formState:{errors:j}}=(0,n.cI)({mode:"onChange"}),[f,P]=(0,a.useState)(null),[q,I]=(0,a.useState)(null),[y,N]=(0,a.useState)(null),[S,L]=(0,a.useState)(!1),login=e=>{try{(0,i.signIn)("credentials",{redirect:!1,email:e.nameId,password:e.password}).then(e=>{e?.error?I("メールアドレスまたはパスワードが間違っています。"):p.push("/")})}catch(e){I("認証処理で予期せぬエラーが発生しました。")}},userExist=e=>{fetch("/api/userexist",{method:"POST",body:JSON.stringify({userId:e})}).then(async e=>{if(200===e.status){let s=await e.json();P(!!s.name)}else console.log("faild.")})},register=e=>{fetch("/api/register",{method:"POST",body:JSON.stringify({userId:e.nameId_b,password:e.password_b})}).then(async s=>{200===s.status?(L(!0),setTimeout(()=>{login({nameId:e.nameId_b,password:e.password_b})},5e3)):N("問題が発生したため、ユーザー登録処理を完了できませんでした。")})};return t.jsx(t.Fragment,{children:(0,t.jsxs)("div",{className:u().wrapper,children:[S&&t.jsx("p",{className:u()["registerd-alert"],children:"ユーザー登録が完了しました。５秒後に自動的にログインします。"}),(0,t.jsxs)("div",{className:u()["login-area"],children:[t.jsx("h2",{children:"ログイン"}),(0,t.jsxs)("form",{onSubmit:w(e=>{login(e)}),children:[(0,t.jsxs)("div",{className:u()["input-box"],children:[t.jsx("label",{htmlFor:"nameId",children:"ユーザーID"}),t.jsx("input",{type:"text",id:"nameId",...b("nameId",{required:!0})}),j.nameId&&t.jsx("p",{className:u()["erro-message"],children:"ユーザーIDを入力してください"})]}),(0,t.jsxs)("div",{className:u()["input-box"],children:[t.jsx("label",{htmlFor:"password",children:"パスワード"}),t.jsx("input",{type:"password",id:"password",...b("password",{required:!0})}),j.password&&t.jsx("p",{className:u()["erro-message"],children:"パスワードを入力してください"})]}),null!==q&&t.jsx("p",{className:u()["erro-message"],children:q}),t.jsx("button",{className:u()["login-btn"],type:"submit",children:"ログイン"})]}),t.jsx("br",{}),t.jsx(d(),{href:"/",children:"トップへ戻る"})]}),0===c&&(0,t.jsxs)("div",{className:u()["login-area"],children:[t.jsx("h2",{children:"ユーザー登録"}),(0,t.jsxs)("form",{onSubmit:x(e=>{register(e)}),children:[(0,t.jsxs)("div",{className:u()["input-box"],children:[t.jsx("label",{htmlFor:"nameId_b",children:"ユーザーID"}),t.jsx("input",{type:"text",id:"nameId_b",...m("nameId_b",{required:{value:!0,message:"ユーザーIDを入力してください。"},maxLength:{value:20,message:"ユーザーIDは20文字以内で入力してください。"},minLength:{value:7,message:"ユーザーIDは7文字以上で入力してください。"},pattern:{value:/^([0-9a-zA-Z]|_|-)+$/g,message:"形式が正しくありません。使用可能な文字は、英数字、[_-」のみです。"},onChange:()=>{let e=g("nameId_b").match(/^([0-9a-zA-Z]|_|-){7,20}$/g);e&&userExist(g("nameId_b"))}})}),_.nameId_b?.message&&t.jsx("p",{className:u()["erro-message"],children:_.nameId_b.message.toString()}),!0===f&&void 0===_.nameId_b&&t.jsx("p",{className:u()["userid-exited"],children:"✖このユーザーIDは既に使用されています。"}),!1===f&&void 0===_.nameId_b&&t.jsx("p",{className:u()["userid-no-exist"],children:"◎使用可能なユーザーIDです。"}),t.jsx("p",{className:u()["validation-info"],children:"使用できる文字は、a～z、A～Z、0～9、ハイフン(-)、アンダーライン(_)です。"})]}),(0,t.jsxs)("div",{className:u()["input-box"],children:[t.jsx("label",{htmlFor:"password_b",children:"パスワード"}),t.jsx("input",{type:"password",id:"password_b",...m("password_b",{required:{value:!0,message:"パスワードを入力してください。"},maxLength:{value:20,message:"パスワードは20文字以内で入力してください。"},minLength:{value:8,message:"パスワードは8文字以上で入力してください。"},onChange:()=>{g("password_b_confarm")&&h("password_b_confarm")}})}),_.password_b?.message&&t.jsx("p",{className:u()["erro-message"],children:_.password_b.message.toString()}),t.jsx("label",{htmlFor:"password_b_confarm",style:{margin:"10px auto"},children:"パスワード（確認）"}),t.jsx("input",{type:"password",id:"password_b_confarm",...m("password_b_confarm",{required:{value:!0,message:"確認用パスワードを入力してください。"},validate:e=>e===g("password_b")||"パスワードが一致しません"})}),_.password_b_confarm?.message&&t.jsx("p",{className:u()["erro-message"],children:_.password_b_confarm.message.toString()}),(0,t.jsxs)("p",{className:u()["validation-info"],children:["・パスワードは、8文字以上20文字以下で設定してください。",t.jsx("br",{}),"・できるだけ記号・数字・アルファベットを組み合わせて強固なものにしてください。"]})]}),null!==y&&t.jsx("p",{className:u()["erro-message"],children:y}),t.jsx("button",{className:u()["login-btn"],type:"submit",children:"登録"})]})]})]})})}},53569:e=>{e.exports={wrapper:"content_wrapper__l2_3Z","registerd-alert":"content_registerd-alert__CDejw","login-btn":"content_login-btn__J_Grc","login-area":"content_login-area__XzFvk","input-box":"content_input-box__W03nI","erro-message":"content_erro-message__YJqJk","userid-exited":"content_userid-exited__BwRi1","userid-no-exist":"content_userid-no-exist__YSLpq","validation-info":"content_validation-info__26OGi"}},37129:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>Login});var t=r(55041),a=r(83873),n=r(50217),i=r(6962),o=r(18722),l=r(11208),d=r(53524),c=r(38584),u=r(89385);let p=(0,u.createProxy)(String.raw`/var/www/next-creator/app/[lang]/auth/login/content.tsx`),{__esModule:m,$$typeof:x}=p,g=p.default,h=new d.PrismaClient;async function Login({params:{lang:e}}){let s=await (0,o.getServerSession)(i.Y);s&&(0,l.redirect)("/");let r=await h.user.count();return(0,t.jsxs)(t.Fragment,{children:[t.jsx(a.Z,{lang:e}),t.jsx(g,{locales:c.S.Z5,defaultLang:c.S.ZP,useLang:e,localeLabels:c.S.p8,userCount:r}),t.jsx(n.Z,{})]})}}};var s=require("../../../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),r=s.X(0,[8807,9059,7737,7253,1419,8722,8396,1208,6962,7408,7350,3239,598],()=>__webpack_exec__(81917));module.exports=r})();