"use strict";exports.id=7408,exports.ids=[7408],exports.modules={7408:(t,e,a)=>{a.d(e,{ET:()=>getStrDatetime,O1:()=>randomString,Tr:()=>getSavePath,_2:()=>postBodyFormat,dF:()=>pageJudg,m3:()=>pathExist});var r=a(57147),i=a.n(r),n=a(73292),s=a(17718);let o=process.env.APP_ROOT_PATH,l=`${o}/public/media`;async function getSavePath(t){let e=getStrDatetime("y"),a=getStrDatetime("m"),r=getStrDatetime("d"),i=`${l}/${e}/${a}/${r}`,s=`/media/${e}/${a}/${r}`,o=randomString(15);return process.umask(0),await pathExist(`${l}/${e}`)||await (0,n.mkdir)(`${l}/${e}`,"0755"),await pathExist(`${l}/${e}/${a}`)||await (0,n.mkdir)(`${l}/${e}/${a}`,"0755"),await pathExist(i)||await (0,n.mkdir)(i,"0755"),{savePath:i,savePathRelative:s,filePath:`${i}/${o}_${t}`,filePathRelative:`${s}/${o}_${t}`}}function randomString(t=10){let e="0123456789abcdefghijklmnopqrstuvwxyz",a=(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZ").length,r="";for(let i=0;i<t;i++)r+=e[Math.floor(Math.random()*a)];return r}function getStrDatetime(t,e){let a=e?new Date(e):new Date,r=a.getFullYear(),i=("0"+(a.getMonth()+1)).slice(-2),n=("0"+a.getDate()).slice(-2),s=("0"+a.getHours()).slice(-2),o=("0"+a.getMinutes()).slice(-2),l=("0"+a.getSeconds()).slice(-2);return t?t.replace("y",`${r}`).replace("m",`${i}`).replace("d",`${n}`).replace("h",`${s}`).replace("mi",`${o}`).replace("s",`${l}`):r+"-"+i+"-"+n+" "+s+":"+o+":"+l}async function pathExist(t){return new Promise(e=>{i().access(t,r.constants.F_OK,t=>{t?e(!1):e(!0)})})}function postBodyFormat(t){return t.replaceAll("{{root-domain-url}}",process.env.APP_URL)}function pageJudg(t){let e=(0,s.headers)().get("x-url");if(!e)return null;let a=new URL(e).pathname;return!!("home"===t&&a.match(/^\/\w{0,2}$/)||"post"===t&&a.match(/^(\/\w{0,2})?\/article((\?[\w=]+)|(\/[\w-]+))?$/))||!!("admin"===t&&a.match(/^(\/\w{0,2})?\/admin\//))}}};