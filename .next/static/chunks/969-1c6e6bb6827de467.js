(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[969],{24228:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Content},getCategory:function(){return getCategory}});var n=a(76130),s=a(45084),r=a(70530),l=a(7444),o=a.n(l),i=a(25332),c=a(18030),d=a(2681),u=a(48116),m=a(59006),_=a.n(m);let h=_()(()=>Promise.all([a.e(703),a.e(612)]).then(a.bind(a,83612)),{loadableGenerated:{webpack:()=>[83612]}});function Content(e){let{useLang:t,defaultLang:a,locales:l,localeLabels:m}=e,[_,g]=(0,s.useState)("new"),[p,f]=(0,s.useState)(0),[b,x]=(0,s.useState)("draft"),[j,y]=(0,s.useState)(null),[v,w]=(0,s.useState)(null),[k,N]=(0,s.useState)(null),[S,C]=(0,s.useState)("thumb"),[E,L]=(0,s.useState)(null),T=(0,s.useRef)(null),P=(0,s.useRef)({}),M=(0,s.useRef)({}),O=(0,s.useRef)({}),D=(0,s.useRef)(null),R=(0,s.useRef)(null),I=(0,r.useSession)(),z=!1;function sendPostData(e){var t,a,n;let s={},r={},o={};for(let e of l){s[e]=P.current[e].value;let t=M.current[e].getData(),a=document.createElement("div");a.innerHTML=t;let n=new RegExp("^".concat("http://ryuseiweb.localhost","/")),l=/^(\.\.?\/)+|^https?\:\/\/[^\/]+\//;for(let e of[...a.querySelectorAll("img")])if(n.test(e.src)){for(let[t,a]of(e.src=e.src.replace(l,"{{root-domain-url}}/"),e.srcset.split(" ").entries()))if(0===t||t%3==0){let t=a.replace(l,"{{root-domain-url}}/");e.srcset=e.srcset.replace(a,t)}}else console.log(e.src);r[e]=a.innerHTML,o[e]=O.current[e].value}let i=k?Object.keys(k).filter(e=>!!k[Number(e)]):[],c={};if(k&&("draft"===b||"publish"===b)&&"edit"===_){let e=0!==R.current.CategoryPost.length?i.filter(e=>{for(let t of R.current.CategoryPost)if(t.category.id===Number(e))return!1;return!0}):i,t=null===(n=R.current)||void 0===n?void 0:n.CategoryPost.filter(e=>{for(let t of i)if(Number(t)===e.category.id)return!1;return!0});e.length>0&&(c.create=[...e.map(e=>({category:{connect:{id:Number(e)}}}))]),t&&t.length>0&&(c.deleteMany=[...t.map(e=>({postId:p,categoryId:Number(e.category.id)}))])}else c.create=k?Object.keys(k).filter(e=>!!k[Number(e)]).map(e=>({category:{connect:{id:Number(e)}}})):[];let d=null;""!==D.current.value&&(d=D.current.value);let u={title:s,body:r,description:o,permalink:d,media:{connect:{id:j}},CategoryPost:c,status:e,user:{connect:{id:Number(null===(a=I.data)||void 0===a?void 0:null===(t=a.user)||void 0===t?void 0:t.id)}}};j||delete u.media,fetch("/api/post/".concat(("draft"===b||"publish"===b)&&"edit"===_?"update":"create"),{method:"POST",body:JSON.stringify(("draft"===b||"publish"===b)&&"edit"===_?{id:p,update:u}:u)}).then(t=>{t.ok&&("new"===_&&"draft"===e?alert("新規投稿を下書きとして保存しました。"):"new"===_&&"publish"===e?alert("新規投稿を公開しました。"):"edit"===_&&"publish"===b&&"draft"===e?alert("公開投稿を下書きに変更しました。"):"edit"===_&&"draft"===b&&"publish"===e?alert("下書きを公開しました。"):"edit"===_&&"draft"===b&&"draft"===e?alert("下書きを更新しました。"):"edit"===_&&"publish"===b&&"publish"===e?alert("投稿記事を更新しました。"):"edit"===_&&"trash"===e&&alert("記事をゴミ箱に移動しました。"),location.reload())})}return(0,s.useEffect)(()=>((async function(){if(!z){let e=new URL(location.href).searchParams;g(e.get("mode")||"new"),f(Number(e.get("id")||0));let{searchEdit:t,selectableList:a}=await getCategory();N(a),w(t),window.addEventListener("thumb-selected",e=>{L((0,n.jsx)("img",{src:e.detail.src,width:800,sizes:"100vw",loading:"lazy"})),y(Number(e.detail.id))}),setTimeout(async()=>{if("edit"===_&&p>0&&l.length===Object.keys(P.current).length&&l.length===Object.keys(M.current).length){var e,t,a;for(let e of(R.current=await getPostData(p),x(R.current.status),l))P.current[e].value=R.current.title[e],M.current[e].setData(R.current.body[e]),R.current.description&&(O.current[e].value=R.current.description[e]);(null===(e=R.current)||void 0===e?void 0:e.permalink)&&(D.current.value=R.current.permalink),L((0,n.jsx)("img",{src:"../../api/media-stream?id=".concat(null===(t=R.current.media)||void 0===t?void 0:t.id,"&w=800"),width:800,sizes:"100vw",loading:"lazy"})),y((null===(a=R.current.media)||void 0===a?void 0:a.id)||null),N(e=>{if(e&&R.current.CategoryPost)for(let t of R.current.CategoryPost)e[t.category.id]=!0;return e})}},400)}})(),()=>{z=!0}),[_,p]),(0,n.jsxs)("div",{className:o().wrapper,children:[(0,n.jsxs)("h2",{children:["new"===_?"新規作成":"記事編集","edit"===_&&(0,n.jsxs)("span",{className:o().status,children:["ステータス：","publish"===b?"公開済み":"下書き"]})]}),(0,n.jsxs)("div",{className:o().container,children:[(0,n.jsx)("div",{className:o().edit_control,children:(0,n.jsx)(h,{locales:l,defaultLang:t,localeLabels:m,titleInputRef:P,editorRef:M,descInputRef:O,mediaSelectDialog:T,setMediaInsertMode:C})}),(0,n.jsxs)("div",{className:o().widgets,children:[(0,n.jsxs)("div",{className:o().thumbnail,children:[(0,n.jsx)("h3",{children:"サムネイル設定"}),(0,n.jsxs)("div",{className:o().selector,children:[(0,n.jsxs)("span",{className:o().no_thumb_text,children:["No thumbnail",(0,n.jsx)("br",{}),"追加する"]}),E||(0,n.jsx)("img",{style:{display:"none"},src:"",loading:"lazy"}),(0,n.jsx)("button",{className:o().select_btn,onClick:()=>{var e;null===(e=T.current)||void 0===e||e.showModal(),C("thumb")},children:"サムネイル追加"})]}),E&&(0,n.jsxs)("button",{className:o().delete,onClick:()=>{L(null),y(null)},children:[(0,n.jsx)(i.G,{icon:d.Vui}),"\xa0削除"]}),(0,n.jsx)("dialog",{className:o().thumbSelect,ref:T,children:(0,n.jsxs)("div",{className:o().thumb_select_dialog,children:[(0,n.jsx)("h3",{children:"thumb"===S?"サムネイルの選択":"メディアの挿入"}),(0,n.jsxs)("button",{className:o().close,onClick:()=>{var e;null===(e=T.current)||void 0===e||e.close()},children:[(0,n.jsx)(i.G,{fontSize:"16pt",icon:c.g82}),"\xa0閉じる"]}),(0,n.jsx)("div",{className:o().gallery_component,children:(0,n.jsx)(u.default,{mode:"post_new",thumbSelectDialog:T,mediaInsertMode:S})})]})})]}),(0,n.jsxs)("div",{className:o().permalink,children:[(0,n.jsx)("h3",{children:"パーマリンク"}),(0,n.jsxs)("div",{className:o().input,children:[(0,n.jsx)("span",{children:"/"}),(0,n.jsx)("input",{ref:D,type:"text",placeholder:"my-post"})]})]}),(0,n.jsxs)("div",{className:o().category,children:[(0,n.jsx)("h3",{children:"カテゴリー選択"}),(0,n.jsx)("div",{className:o().tree_view,children:v&&function getCategoryNode(e){return(0,n.jsx)("ul",{role:"tree",className:o().category_group,children:e.map(e=>(0,n.jsxs)("li",{role:"treeitem",tabIndex:0,children:[(0,n.jsxs)("div",{className:o().item,onMouseOver:t=>{t.stopPropagation(),k[e.id]||t.currentTarget.classList.add(o().bg_color)},onMouseOut:t=>{t.stopPropagation(),k[e.id]||t.currentTarget.classList.remove(o().bg_color)},children:[(0,n.jsxs)("label",{htmlFor:"cat_id_".concat(e.id),className:o().select_cat_label,style:{backgroundColor:k[e.id]?"var( --primary-color )":"transparent"},children:[e.name[t]," - ",e.slug]}),(0,n.jsx)("input",{type:"checkbox",name:"select_cat",defaultValue:e.id,id:"cat_id_".concat(e.id),checked:k[e.id],onClick:e=>{let t=Number(e.currentTarget.value);N(e=>{let a={...e};return a[t]=!a[t],a})}}),(0,n.jsx)("span",{className:o().icon,children:e.icon?(0,n.jsx)("img",{src:"../api/media-stream/icon?id=".concat(e.id),"aria-label":"アイコン",loading:"lazy"}):(0,n.jsx)(i.G,{icon:c.cLY})}),e.name[t],(0,n.jsx)("span",{style:{marginLeft:"15px",color:"gray"},children:e.slug})]}),e.children.length>0&&getCategoryNode(e.children)]},e.id))})}(v)})]})]})]}),(0,n.jsx)("div",{className:o().post_push,children:"new"===_||"draft"===b?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{className:o().draft,onClick:()=>{sendPostData("draft")},children:"下書き保存"}),(0,n.jsx)("button",{className:o().publish,onClick:()=>{sendPostData("publish")},children:"公開"})]}):(0,n.jsxs)(n.Fragment,{children:[("publish"===b||"trash"===b)&&(0,n.jsx)("button",{className:o().draft,onClick:()=>{sendPostData("draft")},children:"下書きに戻す"}),"publish"===b&&(0,n.jsx)("button",{className:o().update,onClick:()=>{sendPostData("publish")},children:"更新"})]})})]})}async function getCategory(){return new Promise(e=>{fetch("/api/category/get",{method:"POST"}).then(async t=>{if(t.ok){let a={},n=await t.json(),searchEdit=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=[];for(let[s,r]of e.entries())t===r.parent&&(a[r.id]=!1,n.push({...r,children:searchEdit(e,r.id)}));return n};e({searchEdit:searchEdit(n,0),selectableList:a})}})})}async function getPostData(e){return new Promise(t=>{fetch("/api/post/get",{method:"POST",body:JSON.stringify({id:e})}).then(async e=>{e.ok?t(await e.json()):t(null)})})}},29674:function(e,t,a){"use strict";a.r(t),a.d(t,{LoginButton:function(){return LoginButton},LogoutButton:function(){return LogoutButton},RegisterButton:function(){return RegisterButton}});var n=a(76130),s=a(70530),r=a(76208),l=a.n(r);let LoginButton=()=>(0,n.jsx)("button",{className:"".concat(l().button," ").concat(l()["login-button"]),onClick:()=>(0,s.signIn)(),children:"ログイン"}),LogoutButton=e=>{let{lang:t,localStack:a}=e;return(0,n.jsx)("button",{className:"".concat(l().button," ").concat(l()["logout-button"]),onClick:()=>(0,s.signOut)(),children:a.logout})},RegisterButton=()=>(0,n.jsx)("button",{className:"".concat(l().button," ").concat(l()["register-button"]),onClick:()=>(0,s.signIn)(),children:"登録"})},60070:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return HeaderScrpt}});var n=a(76130),s=a(45084);function HeaderScrpt(){return(0,s.useEffect)(()=>()=>{},[]),(0,n.jsx)(n.Fragment,{})}},66964:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return LangChange}});var n=a(76130),s=a(57549),r=a.n(s),l=a(15527),o=a(94766),i=a(45084),c=a(25332),d=a(18030),u=a(47967),m=a.n(u),_=JSON.parse('{"S":{"ZP":"ja","Z5":["ja","en"],"p8":{"ja":{"ja":"日本語","en":"英語"},"en":{"ja":"Japanese","en":"English"}}}}');function LangChange(e){let{lang:t,flagsSVG:a,localeStack:s}=e,u=(0,i.useRef)(null),[h,g]=(0,i.useState)(!1),[p,f]=(0,i.useState)(void 0),[b,x]=(0,i.useState)(t),j=(0,l.usePathname)(),y=(0,l.useSearchParams)().toString(),v=new RegExp("^/(".concat(_.S.Z5.join("|"),")(/\\w+|$)")),w=new RegExp("^/(".concat(_.S.Z5.join("|"),")(/|$)")),k=(0,l.useRouter)();function selectorUnVisible(){g(!1),document.body.removeEventListener("click",selectorUnVisible)}return(0,i.useEffect)(()=>{u.current=document.getElementById("language-change-toggle"),u.current.addEventListener("click",()=>{g(!0),setTimeout(()=>{document.body.addEventListener("click",selectorUnVisible)},200)});let e=(0,o.getCookie)("use-language");f(e),x(null!=e?e:t)},[]),(0,n.jsxs)("div",{className:"".concat(r().lang_selector," ").concat(h?r().visible:""),children:[(0,n.jsxs)("button",{className:p?void 0:r().selected,onClick:()=>{(0,o.deleteCookie)("use-language",{secure:!0,sameSite:"lax"}),location.reload()},children:[(0,n.jsx)(c.G,{icon:d.g4A}),"\xa0",s.default]}),_.S.Z5.map((e,l)=>(0,n.jsxs)("button",{className:b===e&&p?r().selected:void 0,onClick:t=>{t.stopPropagation();let a=j;v.test(j)&&(a=a.replace(w,"/"));let n=(_.S.ZP===e?"":"/"+e)+a+(""===y?"":"?"+y);(0,o.setCookie)("use-language",e,{secure:!0,sameSite:"lax"}),x(e),f(e),k.push(n)},children:[(0,n.jsx)("span",{className:r().flag,children:(0,n.jsx)(m(),{className:r().image,src:a[e],alt:s["flag-icon-alt"]})}),"\xa0",_.S.p8[t][e]]},l))]})}},27402:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return ThemeChangeSwitch}});var n=a(76130),s=a(45084),r=a(25332),l=a(18030),o=a(94766);function ThemeChangeSwitch(e){let{style:t}=e,[a,i]=(0,s.useState)("system"),[c,d]=(0,s.useState)("Theme"),u=!1;(0,s.useEffect)(()=>((async function(){if(!u){let e=(0,o.getCookie)("use-theme",{secure:!0,sameSite:!0});e&&["system","light","dark"].includes(e)&&handleThemeChange(e)}})(),()=>{u=!0}),[]);let handleThemeChange=e=>{let t=e||a;switch(console.log(t),t){case"system":i("light"),d("Light"),(0,o.setCookie)("use-theme","system",{secure:!0,sameSite:!0}),document.documentElement.classList.add("light-theme"),document.documentElement.classList.contains("ck-theme-dark")&&document.documentElement.classList.remove("ck-theme-dark");break;case"light":i("dark"),d("Dark"),(0,o.setCookie)("use-theme","light",{secure:!0,sameSite:!0}),document.documentElement.classList.replace("light-theme","dark-theme"),document.documentElement.classList.contains("ck-theme-dark")||document.documentElement.classList.add("ck-theme-dark");break;case"dark":i("system"),d("Theme"),(0,o.deleteCookie)("use-theme",{secure:!0,sameSite:!0}),document.documentElement.classList.remove("dark-theme"),window.matchMedia("(prefers-color-scheme: dark)").matches&&document.documentElement.classList.add("ck-theme-dark")}};return(0,n.jsxs)("button",{onClick:()=>handleThemeChange(),title:"テーマ："+("Theme"===c?"Default":c),"aria-label":"テーマ："+("Theme"===c?"Default":c),style:{...t,color:"var( --foreground-color )",margin:"0 5px"},children:["system"===a&&(0,n.jsx)(r.G,{width:"20px",icon:l.DhN}),"dark"===a&&(0,n.jsx)(r.G,{width:"20px",icon:l.DBF}),"light"===a&&(0,n.jsx)(r.G,{color:"black",width:"20px",icon:l.enB})]})}},441:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return CategoriesDropdown}});var n=a(76130),s=a(46153),r=a.n(s),l=a(45084),o=a(25332),i=a(18030),c=a(97385),d=a.n(c),u=a(24228);function CategoriesDropdown(e){let{lang:t,defaultLang:a}=e,[s,c]=(0,l.useState)(null),[m,_]=(0,l.useState)(!1),h=!1;return(0,l.useEffect)(()=>((async function(){if(!h){let e=function generateCategoryJSX(e){return(0,n.jsx)(n.Fragment,{children:e.map(e=>(0,n.jsxs)("li",{children:[(0,n.jsx)(d(),{className:r().cat_link,href:"".concat(t===a?"":"/"+t,"/category/").concat(e.slug),children:(0,n.jsxs)("div",{className:r().cat_record,children:[(0,n.jsx)("span",{className:r().icon,style:{marginRight:e.icon_mime?"25px":"10px"},children:e.icon_mime?(0,n.jsx)("img",{src:"".concat("http://ryuseiweb.localhost","/api/media-stream/icon?id=").concat(e.id),alt:"カテゴリーアイコン",loading:"lazy"}):(0,n.jsx)(o.G,{className:r().fontawesome,icon:i.olY})}),(0,n.jsx)("span",{className:r().name,children:e.name[t]})]})}),e.children.length>0&&(0,n.jsx)("ul",{className:r().sub_tree,children:generateCategoryJSX(e.children)})]},e.id))})}((await (0,u.getCategory)()).searchEdit);c(e);let s=document.getElementById("open-category-dropdown");s.parentElement.addEventListener("mouseover",()=>{_(!0)}),s.parentElement.addEventListener("click",()=>{_(!0)}),s.parentElement.addEventListener("mouseout",()=>{_(!1)})}})(),()=>{h=!0}),[]),(0,n.jsx)("div",{className:"".concat(r().cate_tree_wrap," ").concat(m?r().show:""),children:(0,n.jsx)("ul",{className:"".concat(r().cate_tree," ").concat(m?r().show:""),children:s})})}},24853:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Contactform}});var n=a(76130),s=a(32220),r=a.n(s),l={src:"/_next/static/media/ball-triangle.73fc7083.svg",height:57,width:57,blurWidth:0,blurHeight:0},o=a(45084),i=a(79014),c=a(47967),d=a.n(c);function Contactform(e){let{lang:t,localeStack:a}=e,s=(0,o.useRef)(null),[c,u]=(0,o.useState)(!1),[m,_]=(0,o.useState)(!1),{register:h,reset:g,handleSubmit:p,formState:{errors:f}}=(0,i.cI)({mode:"onChange"});function dialogClose(){console.log("close"),u(!1),setTimeout(()=>{var e;null===(e=s.current)||void 0===e||e.close()},300)}return(0,o.useEffect)(()=>{let e=document.getElementById("open-contactform");e.addEventListener("click",()=>{var e;null===(e=s.current)||void 0===e||e.showModal(),setTimeout(()=>{u(!0)},50)})},[]),(0,n.jsx)("dialog",{className:"".concat(r().contactform," ").concat(c?"show "+r().show:""),ref:s,children:(0,n.jsxs)("div",{className:r().content,children:[(0,n.jsx)("h2",{children:a["contact-heading2"]}),(0,n.jsxs)("form",{onSubmit:p(e=>{_(!0),fetch("/api/contact",{method:"POST",body:JSON.stringify({name:e.name,email:e.email,subject:e.subject,body:e.body})}).then(async e=>{if(e.ok){let t=await e.json();t.success?(alert(a["send-success-message"]),dialogClose()):alert(a["send-faild-message"]),_(!1),g()}else alert(a["send-server-error-message"])})}),children:[(0,n.jsxs)("label",{htmlFor:"name-input",children:[a["name-label"],"*"]}),(0,n.jsx)("input",{id:"name-input",type:"text",...h("name",{required:{value:!0,message:a["name.error.message.required"]},maxLength:{value:50,message:a["name.error.message.maxLength"]}})}),f.name&&(0,n.jsx)("span",{className:r().error_msg,children:f.name.message}),(0,n.jsxs)("label",{htmlFor:"email-input",children:[a["email-label"],"*"]}),(0,n.jsx)("input",{id:"email-input",type:"email",...h("email",{required:{value:!0,message:a["email.error.message.required"]},maxLength:{value:100,message:a["email.error.message.maxLength"]},pattern:{value:/^[a-zA-Z0-9-_\.]+@[a-zA-Z0-9-_\.]+$/,message:a["email.error.message.pattern"]}})}),f.email&&(0,n.jsx)("span",{className:r().error_msg,children:f.email.message}),(0,n.jsxs)("label",{htmlFor:"subject-input",children:[a["subject-label"],"*"]}),(0,n.jsxs)("select",{id:"subject-input",...h("subject",{required:!0}),children:[(0,n.jsx)("option",{value:"job",children:a["subject-option-job"]}),(0,n.jsx)("option",{value:"feedback",children:a["subject-option-feedback"]}),(0,n.jsx)("option",{value:"other",children:a["subject-option-other"]})]}),(0,n.jsxs)("label",{htmlFor:"body-input",children:[a["body-label"],"*"]}),(0,n.jsx)("textarea",{id:"body-input",...h("body",{required:{value:!0,message:a["body.error.message.required"]}})}),f.body&&(0,n.jsx)("span",{className:r().error_msg,children:f.body.message}),(0,n.jsxs)("div",{className:r().data_control,children:[(0,n.jsxs)("button",{type:"submit",disabled:m,className:r().submit,children:[m&&(0,n.jsx)(d(),{src:l,style:{display:"inline-block",width:"1em",marginRight:"10px",height:"1em",transform:"translateY( -4px )"},alt:a["sending-image-alt"]}),a["send-button"]]}),(0,n.jsx)("button",{className:r().close,type:"button",onClick:dialogClose,children:a["cancel-button"]})]})]})]})})}},48116:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return MediaGallery}});var n=a(76130),s=a(45084),r=a(25332),l=a(2681),o=a(18030),i=a(89046),c=a.n(i),d=a(66717);function MediaGallery(e){let{mode:t="default",thumbSelectDialog:a,mediaInsertMode:i}=e,[u,m]=(0,s.useState)(null),[_,h]=(0,s.useState)(null),[g,p]=(0,s.useState)(!1),[f,b]=(0,s.useState)(!1),x=(0,s.useRef)(0),j=(0,s.useRef)("desc");function loadMediaInfo(e,s){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"desc";arguments.length>3&&arguments[3],arguments.length>4&&arguments[4],fetch("/api/get-media",{method:"POST",cache:"no-store",body:JSON.stringify({skip:e,take:s,sort:o})}).then(async e=>{if(e.ok){let s=await e.json();b(s.isNext),j.current=o,m([...0!==x.current?u:[],...s.mediaList.map(e=>(function(e){let{id:t,name:a,src:s,srcset:o,width:i,sizes:d,mode:u,showDetailFunc:m,deleteFunc:_,thumbSelectDialog:h,mediaInsertMode:g}=e;return(0,n.jsx)("li",{tabIndex:0,"aria-label":a,"data-id":t,onClick:e=>{m(e.currentTarget.dataset.id)},onKeyDown:e=>{"Enter"===e.code&&m(e.currentTarget.dataset.id)},children:(0,n.jsxs)("div",{className:c().media_wrapper,children:[(0,n.jsx)("img",{src:s,srcSet:o,sizes:d,width:i,loading:"lazy"}),(0,n.jsx)("span",{className:c().name,title:a,children:a}),"post_new"===u&&"ck"===g&&(0,n.jsx)("button",{className:c().insert,"data-width":i,"data-id":t,"data-src":s,"data-srcset":o||"",onClick:e=>{var t;e.stopPropagation();let a=new CustomEvent("media-selected",{detail:{src:e.currentTarget.dataset.src,srcset:e.currentTarget.dataset.srcset,width:e.currentTarget.dataset.width}});window.dispatchEvent(a),null==h||null===(t=h.current)||void 0===t||t.close()},children:"挿入"}),"post_new"===u&&"thumb"===g&&(0,n.jsx)("button",{className:c().insert,"data-width":i,"data-id":t,"data-src":s,"data-srcset":o||"",onClick:e=>{var t;e.stopPropagation();let a=new CustomEvent("thumb-selected",{detail:{src:"../../api/media-stream?id=".concat(e.currentTarget.dataset.id,"&w=800"),id:e.currentTarget.dataset.id}});window.dispatchEvent(a),null==h||null===(t=h.current)||void 0===t||t.close()},children:"選択"}),(0,n.jsxs)("button",{className:c().delete,"data-id":t,"data-name":a,onClick:e=>{e.stopPropagation();let t=e.currentTarget.dataset;console.log(u,g),console.log("post_new"===u&&"thumb"===g&&"goog"),_(t.id,t.name)},children:[(0,n.jsx)(r.G,{icon:l.Vui}),"\xa0削除"]})]})},t)})({id:e.id,name:e.name,src:"../../api/media-stream?id="+e.id+"&w=800",srcset:Object.keys(e.url.paths).filter(e=>"default"!==e).map(t=>"../../api/media-stream?id="+e.id+"&w="+t+" ".concat(t,"w, ")).join(" ").replace(/,\s$/,""),width:Number(Object.keys(e.url.paths).slice(-2)[0]),sizes:"800px",deleteFunc:deleteMedia,showDetailFunc:showMediaDetailModal,thumbSelectDialog:a,mode:t,mediaInsertMode:i}))]),x.current=0}})}async function mediaUpload(e){if(e.currentTarget.files){let t=new FormData;t.set("upload",e.currentTarget.files[0]);let a=await fetch("/api/upload",{method:"POST",body:t,cache:"no-cache"});a.ok?(loadMediaInfo(0,30),x.current=0):alert("アップロードに失敗しました。")}}function deleteMedia(e,t){confirm("ファイル「".concat(t,"」を削除しますか？"))&&fetch("/api/rm-media",{method:"POST",body:JSON.stringify({id:e}),cache:"no-store"}).then(e=>{e.ok?loadMediaInfo(0,30,j.current):alert("処理に失敗しました。")})}function showMediaDetailModal(e){fetch("/api/get-media-first",{method:"POST",body:JSON.stringify({id:e})}).then(async e=>{if(e.ok){let t=await e.json();h((0,n.jsx)("img",{src:"../../api/media-stream?w=800&id=".concat(t.id),srcSet:Object.keys(t.url.paths).filter(e=>"default"!==e).map(e=>"../../api/media-stream?id="+t.id+"&w="+e+" ".concat(e,"w, ")).join(" ").replace(/,\s$/,""),width:Number(Object.keys(t.url.paths).slice(-2)[0]),sizes:"100vw",loading:"lazy"})),p(!0)}})}return(0,s.useEffect)(()=>{loadMediaInfo(0,30)},[i]),(0,n.jsxs)("div",{className:c().gallery_wrapper,children:[(0,n.jsxs)("div",{className:c().view_control+" ".concat("post_new"===t&&c().block),children:[(0,n.jsx)("label",{className:c().media_upload_label,htmlFor:"media-upload-trigger",children:"アップロード"}),(0,n.jsx)("input",{id:"media-upload-trigger",type:"file","aria-label":"アップロードする",role:"button",onChange:mediaUpload}),(0,n.jsxs)("fieldset",{children:[(0,n.jsx)("legend",{children:"期間"}),(0,n.jsx)("input",{type:"datetime-local",value:(0,d.ET)()}),"\xa0～\xa0",(0,n.jsx)("input",{type:"datetime-local",max:(0,d.ET)(),value:(0,d.ET)()})]}),(0,n.jsx)("label",{htmlFor:"view-control-sort",children:"並び替え"}),(0,n.jsxs)("select",{id:"view-control-sort",onChange:e=>loadMediaInfo(0,30,e.target.value),children:[(0,n.jsx)("option",{value:"desc",children:"新しい順"}),(0,n.jsx)("option",{value:"asc",children:"古い順"})]})]}),(0,n.jsx)("ul",{children:u&&u}),(0,n.jsx)("div",{className:c().media_get_more,hidden:!f,children:(0,n.jsx)("button",{onClick:()=>{var e;e=x.current,x.current=e+30,loadMediaInfo(x.current,30,j.current)},children:"さらに表示▶"})}),(0,n.jsx)("div",{className:"".concat(c().media_viewr_modal_back," ").concat(g?c().show:""),inert:g?void 0:"","data-modal":"wrapper",onClick:e=>{let t=e.target.dataset;t.modal&&p(!1)},children:(0,n.jsxs)("div",{className:c().media_viewr_modal,children:[(0,n.jsx)("button",{className:c().close,title:"閉じる","aria-label":"閉じる",onClick:()=>p(!1),children:(0,n.jsx)(r.G,{icon:o.g82})}),(0,n.jsx)("div",{className:c().media_view,children:_&&_})]})})]})}},66717:function(e,t,a){"use strict";function getStrDatetime(e,t){let a=t?new Date(t):new Date,n=a.getFullYear(),s=("0"+(a.getMonth()+1)).slice(-2),r=("0"+a.getDate()).slice(-2),l=("0"+a.getHours()).slice(-2),o=("0"+a.getMinutes()).slice(-2),i=("0"+a.getSeconds()).slice(-2);return e?e.replace("y","".concat(n)).replace("m","".concat(s)).replace("d","".concat(r)).replace("h","".concat(l)).replace("mi","".concat(o)).replace("s","".concat(i)):n+"-"+s+"-"+r+" "+l+":"+o+":"+i}a.d(t,{ET:function(){return getStrDatetime}}),a(45084)},7444:function(e){e.exports={wrapper:"content_wrapper__Y1C08",status:"content_status__ZEHeh",container:"content_container__y8b2G",edit_control:"content_edit_control__cibdZ",widgets:"content_widgets__zE8iG",thumbnail:"content_thumbnail__Ebrje",selector:"content_selector__psKAe",no_thumb_text:"content_no_thumb_text__MwOfl",select_btn:"content_select_btn__PusDU",delete:"content_delete__Mzydi",thumb_select_dialog:"content_thumb_select_dialog__lw7hZ",close:"content_close__3moQY",gallery_component:"content_gallery_component__Kd_kO",permalink:"content_permalink__eaaWY",input:"content_input__UckYg",category:"content_category__hK2_O",tree_view:"content_tree_view__wQOlW",category_group:"content_category_group__gGYpu",item:"content_item__yQpuY",select_cat_label:"content_select_cat_label__X9qHr",icon:"content_icon__vzGGo",bg_color:"content_bg_color__T1VFW",post_push:"content_post_push__8VMHj",draft:"content_draft__2cT2q",publish:"content_publish__XmPfS",update:"content_update__PEYM2"}},76208:function(e){e.exports={button:"auth-button_button__ga1x_","login-button":"auth-button_login-button__OBTby","logout-button":"auth-button_logout-button__F2aS8","register-button":"auth-button_register-button__hyo0Y"}},72850:function(e){e.exports={footer:"footer_footer__GQiIV"}},88598:function(e){e.exports={admin_toolbar:"header_admin_toolbar__Xx2_o",tool_links:"header_tool_links__c58b8",status_box:"header_status_box__Q3259",header:"header_header__Svpdj",toolbar_enable:"header_toolbar_enable__6a_mn",menubar_mobile:"header_menubar_mobile__shQm7",siteTitle:"header_siteTitle__E0Jrm",text:"header_text__qUL0_",navigations:"header_navigations__huu1m",default:"header_default__u_VB4",author_sns:"header_author_sns__ucv3c"}},57549:function(e){e.exports={lang_selector:"lang-change_lang_selector__Z4LOp",flag:"lang-change_flag__MZwHv",image:"lang-change_image__MfySu",selected:"lang-change_selected__WUu6j",visible:"lang-change_visible__JOwWH"}},46153:function(e){e.exports={cate_tree_wrap:"categories-dropdown_cate_tree_wrap___LBEU",cate_tree:"categories-dropdown_cate_tree__hh_gM",sub_tree:"categories-dropdown_sub_tree__m7Nh_",cat_link:"categories-dropdown_cat_link__l0QLh",cat_record:"categories-dropdown_cat_record__EeArx",icon:"categories-dropdown_icon__v_t1L",fontawesome:"categories-dropdown_fontawesome__yZcrA",name:"categories-dropdown_name__3ff8C",show:"categories-dropdown_show__vg1VU"}},32220:function(e){e.exports={contactform:"contactform_contactform__Ihl6b",content:"contactform_content__lLh1K",error_msg:"contactform_error_msg__Wxhds",data_control:"contactform_data_control__MhJAA",submit:"contactform_submit__N5kzE",close:"contactform_close__4_ZUh",show:"contactform_show__u1xfc"}},89046:function(e){e.exports={gallery_wrapper:"media-gallery_gallery_wrapper__mk4RY",view_control:"media-gallery_view_control__yJZK2",media_upload_label:"media-gallery_media_upload_label__SGEux",block:"media-gallery_block__DmZRv",media_wrapper:"media-gallery_media_wrapper__zP4z_",name:"media-gallery_name__bkjNG",insert:"media-gallery_insert__uRjKN",delete:"media-gallery_delete__roX_g",media_get_more:"media-gallery_media_get_more__4lIjD",media_viewr_modal_back:"media-gallery_media_viewr_modal_back__2BCUh",media_viewr_modal:"media-gallery_media_viewr_modal__eIl4r",media_view:"media-gallery_media_view__VHeaI",close:"media-gallery_close__aTJ9l",show:"media-gallery_show__bpedL"}},55203:function(e,t,a){"use strict";a.r(t),t.default={src:"/_next/static/media/jp.460a9bc1.svg",height:480,width:640,blurWidth:0,blurHeight:0}},74647:function(e,t,a){"use strict";a.r(t),t.default={src:"/_next/static/media/us.4f2d5574.svg",height:480,width:640,blurWidth:0,blurHeight:0}}}]);