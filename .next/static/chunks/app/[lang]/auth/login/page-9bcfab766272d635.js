(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[666],{62247:function(e,s,n){Promise.resolve().then(n.bind(n,24649)),Promise.resolve().then(n.bind(n,29674)),Promise.resolve().then(n.t.bind(n,88598,23)),Promise.resolve().then(n.t.bind(n,72850,23)),Promise.resolve().then(n.bind(n,60070)),Promise.resolve().then(n.bind(n,66964)),Promise.resolve().then(n.bind(n,27402)),Promise.resolve().then(n.bind(n,441)),Promise.resolve().then(n.bind(n,24853)),Promise.resolve().then(n.bind(n,55203)),Promise.resolve().then(n.bind(n,74647)),Promise.resolve().then(n.t.bind(n,8405,23)),Promise.resolve().then(n.t.bind(n,16139,23))},24649:function(e,s,n){"use strict";n.r(s),n.d(s,{default:function(){return LoginPage}});var r=n(76130),a=n(45084),i=n(79014),t=n(70530),o=n(15527),d=n(97385),l=n.n(d),m=n(68719),c=n.n(m);function LoginPage(e){var s,n,d;let{useLang:m,defaultLang:u,locales:h,localeLabels:p,userCount:_}=e,b=(0,o.useRouter)(),{register:g,handleSubmit:x,getValues:v,trigger:j,formState:{errors:w}}=(0,i.cI)({mode:"onChange"}),{register:f,handleSubmit:I,getValues:N,formState:{errors:P}}=(0,i.cI)({mode:"onChange"}),[S,y]=(0,a.useState)(null),[D,q]=(0,a.useState)(null),[C,F]=(0,a.useState)(null),[L,O]=(0,a.useState)(!1),login=e=>{try{(0,t.signIn)("credentials",{redirect:!1,email:e.nameId,password:e.password}).then(e=>{(null==e?void 0:e.error)?q("メールアドレスまたはパスワードが間違っています。"):b.push("/")})}catch(e){q("認証処理で予期せぬエラーが発生しました。")}},userExist=e=>{fetch("/api/userexist",{method:"POST",body:JSON.stringify({userId:e})}).then(async e=>{if(200===e.status){let s=await e.json();y(!!s.name)}else console.log("faild.")})},register=e=>{fetch("/api/register",{method:"POST",body:JSON.stringify({userId:e.nameId_b,password:e.password_b})}).then(async s=>{200===s.status?(O(!0),setTimeout(()=>{login({nameId:e.nameId_b,password:e.password_b})},5e3)):F("問題が発生したため、ユーザー登録処理を完了できませんでした。")})};return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:c().wrapper,children:[L&&(0,r.jsx)("p",{className:c()["registerd-alert"],children:"ユーザー登録が完了しました。５秒後に自動的にログインします。"}),(0,r.jsxs)("div",{className:c()["login-area"],children:[(0,r.jsx)("h2",{children:"ログイン"}),(0,r.jsxs)("form",{onSubmit:I(e=>{login(e)}),children:[(0,r.jsxs)("div",{className:c()["input-box"],children:[(0,r.jsx)("label",{htmlFor:"nameId",children:"ユーザーID"}),(0,r.jsx)("input",{type:"text",id:"nameId",...f("nameId",{required:!0})}),P.nameId&&(0,r.jsx)("p",{className:c()["erro-message"],children:"ユーザーIDを入力してください"})]}),(0,r.jsxs)("div",{className:c()["input-box"],children:[(0,r.jsx)("label",{htmlFor:"password",children:"パスワード"}),(0,r.jsx)("input",{type:"password",id:"password",...f("password",{required:!0})}),P.password&&(0,r.jsx)("p",{className:c()["erro-message"],children:"パスワードを入力してください"})]}),null!==D&&(0,r.jsx)("p",{className:c()["erro-message"],children:D}),(0,r.jsx)("button",{className:c()["login-btn"],type:"submit",children:"ログイン"})]}),(0,r.jsx)("br",{}),(0,r.jsx)(l(),{href:"/",children:"トップへ戻る"})]}),0===_&&(0,r.jsxs)("div",{className:c()["login-area"],children:[(0,r.jsx)("h2",{children:"ユーザー登録"}),(0,r.jsxs)("form",{onSubmit:x(e=>{register(e)}),children:[(0,r.jsxs)("div",{className:c()["input-box"],children:[(0,r.jsx)("label",{htmlFor:"nameId_b",children:"ユーザーID"}),(0,r.jsx)("input",{type:"text",id:"nameId_b",...g("nameId_b",{required:{value:!0,message:"ユーザーIDを入力してください。"},maxLength:{value:20,message:"ユーザーIDは20文字以内で入力してください。"},minLength:{value:7,message:"ユーザーIDは7文字以上で入力してください。"},pattern:{value:/^([0-9a-zA-Z]|_|-)+$/g,message:"形式が正しくありません。使用可能な文字は、英数字、[_-」のみです。"},onChange:()=>{let e=v("nameId_b").match(/^([0-9a-zA-Z]|_|-){7,20}$/g);e&&userExist(v("nameId_b"))}})}),(null===(s=w.nameId_b)||void 0===s?void 0:s.message)&&(0,r.jsx)("p",{className:c()["erro-message"],children:w.nameId_b.message.toString()}),!0===S&&void 0===w.nameId_b&&(0,r.jsx)("p",{className:c()["userid-exited"],children:"✖このユーザーIDは既に使用されています。"}),!1===S&&void 0===w.nameId_b&&(0,r.jsx)("p",{className:c()["userid-no-exist"],children:"◎使用可能なユーザーIDです。"}),(0,r.jsx)("p",{className:c()["validation-info"],children:"使用できる文字は、a～z、A～Z、0～9、ハイフン(-)、アンダーライン(_)です。"})]}),(0,r.jsxs)("div",{className:c()["input-box"],children:[(0,r.jsx)("label",{htmlFor:"password_b",children:"パスワード"}),(0,r.jsx)("input",{type:"password",id:"password_b",...g("password_b",{required:{value:!0,message:"パスワードを入力してください。"},maxLength:{value:20,message:"パスワードは20文字以内で入力してください。"},minLength:{value:8,message:"パスワードは8文字以上で入力してください。"},onChange:()=>{v("password_b_confarm")&&j("password_b_confarm")}})}),(null===(n=w.password_b)||void 0===n?void 0:n.message)&&(0,r.jsx)("p",{className:c()["erro-message"],children:w.password_b.message.toString()}),(0,r.jsx)("label",{htmlFor:"password_b_confarm",style:{margin:"10px auto"},children:"パスワード（確認）"}),(0,r.jsx)("input",{type:"password",id:"password_b_confarm",...g("password_b_confarm",{required:{value:!0,message:"確認用パスワードを入力してください。"},validate:e=>e===v("password_b")||"パスワードが一致しません"})}),(null===(d=w.password_b_confarm)||void 0===d?void 0:d.message)&&(0,r.jsx)("p",{className:c()["erro-message"],children:w.password_b_confarm.message.toString()}),(0,r.jsxs)("p",{className:c()["validation-info"],children:["・パスワードは、8文字以上20文字以下で設定してください。",(0,r.jsx)("br",{}),"・できるだけ記号・数字・アルファベットを組み合わせて強固なものにしてください。"]})]}),null!==C&&(0,r.jsx)("p",{className:c()["erro-message"],children:C}),(0,r.jsx)("button",{className:c()["login-btn"],type:"submit",children:"登録"})]})]})]})})}},68719:function(e){e.exports={wrapper:"content_wrapper__l2_3Z","registerd-alert":"content_registerd-alert__CDejw","login-btn":"content_login-btn__J_Grc","login-area":"content_login-area__XzFvk","input-box":"content_input-box__W03nI","erro-message":"content_erro-message__YJqJk","userid-exited":"content_userid-exited__BwRi1","userid-no-exist":"content_userid-no-exist__YSLpq","validation-info":"content_validation-info__26OGi"}}},function(e){e.O(0,[314,530,359,97,969,180,622,744],function(){return e(e.s=62247)}),_N_E=e.O()}]);